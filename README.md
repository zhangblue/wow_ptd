# 魔兽世界防暂离程序

项目名称由来：`WOW Prevent temporary departure`简写

## 背景需求

魔兽世界时光服，排队时间太久，开发此程序可以模拟在线状态，让账号不掉线。

## 实现原理

用程序模拟键盘输入，在人物列表与进入游戏之间来回切换，从而达到不掉线的目的。**不知道会不会被封号**

## 使用方法

程序分为两部分: 主程序：`wow_ptd.exe` 和配置文件`config.yaml`. (懒得做交互界面了，用配置文件代替了)，这俩文件必须放在相同目录下

1. 先手动进入到游戏中
2. 在游戏中创建一个宏，名字随便起，宏内容为`/logout`，将此宏放在动作栏上，并设置好快捷键`alt+0`。这个宏的作用是点击自动触发返回人物列表动作，后面的程序需要使用。
3. 根据自己的需求修改`config.yaml`文件并保存
4. 双击执行`wow_ptd.exe`文件，程序运行期间游戏窗口必须全程在前台。
5. 如果不需要了，直接关掉此程序即可。
6. 第一次使用时，最好先观察一下是否能够正确的运行

### 配置文件的配置方法

配置文件格式注意事项：
1. 配置文件中的所有符号都**必须是英文输入法输入的符号**
2. 配置中，参数名的冒号后面是有空格的. 例子：`参数名:<这里有空格>参数值`
3. 只有`wow_title_name`参数的值需要使用`""`号进行包裹，其余参数值都是数字，不需要使用`""`符号包裹

样例默认值如下

```yaml
# 游戏窗口的名称
wow_title_name: "魔兽世界"
# 程序如果异常，自动退出的时间
app_exit_time: 20
# 游戏内挂机时间
in_game_idle_time: 800
# 角色界面停留时间
character_interface_dwell_time: 60
# 小退等待时间
small_refund_waiting_time: 30
# 进入游戏等待时间
entering_game_waiting_time: 30
```

- `wow_title_name`: 游戏窗口的名称。以时光服为例，就是魔兽世界。默认不需要改
- `app_exit_time`: 这个参数是程序出现异常时才用的，不用关心也不要改。
- `in_game_idle_time`: 在游戏内挂机的时间。单位秒
- `character_interface_dwell_time`: 在角色列表界面停留的时间。单位秒
- `small_refund_waiting_time`: 小退时需要等待的时间，比如小退需要读秒。单位秒
- `entering_game_waiting_time`: 进入游戏的等待时间。比如进游戏时需要读条。单位秒


